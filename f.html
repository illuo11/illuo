import React, { useState } from "react";

// –û–¥–Ω–æ—Å—Ç–æ—Ä—ñ–Ω–∫–æ–≤–∏–π React-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–∞–≥–∞–∑–∏–Ω—É –∫–æ—Ñ—Ç—å
// –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î Tailwind CSS –¥–ª—è —Å—Ç–∏–ª—ñ–≤. Default export ‚Äì –≥–æ—Ç–æ–≤–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç.
// –§—É–Ω–∫—Ü—ñ—ó: –∫–∞—Ç–∞–ª–æ–≥, –∫–æ—à–∏–∫, –ø—Ä–æ–º–æ–∫–æ–¥–∏, –ø–æ–¥–∞—Ä—É–Ω–æ–∫ –ø—Ä–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—ñ, –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∞.

export default function HoodieShop() {
  const [products] = useState([
    {
      id: 1,
      name: "–ö–æ—Ñ—Ç–∞ " + "Classic",
      price: 799,
      color: "–ß–æ—Ä–Ω–∞",
      img: "https://images.unsplash.com/photo-1520975914232-8a3d0a5a3b8d?auto=format&fit=crop&w=800&q=60",
      sizes: ["S", "M", "L", "XL"],
    },
    {
      id: 2,
      name: "–ö–æ—Ñ—Ç–∞ Oversize",
      price: 999,
      color: "–°—ñ—Ä–∞",
      img: "https://images.unsplash.com/photo-1600180758890-9a9d9f7b4f3f?auto=format&fit=crop&w=800&q=60",
      sizes: ["M", "L", "XL"],
    },
    {
      id: 3,
      name: "–ö–æ—Ñ—Ç–∞ –∑ –∫–∞–ø—é—à–æ–Ω–æ–º",
      price: 1199,
      color: "–¢–µ–º–Ω–æ-–∑–µ–ª–µ–Ω–∞",
      img: "https://images.unsplash.com/photo-1541099649105-f69ad21f3246?auto=format&fit=crop&w=800&q=60",
      sizes: ["S", "M", "L"],
    },
  ]);

  const [cart, setCart] = useState([]);
  const [promo, setPromo] = useState("");
  const [appliedPromo, setAppliedPromo] = useState(null);
  const [showThank, setShowThank] = useState(false);
  const FREE_SHIPPING_THRESHOLD = 2000; // –≥—Ä–∏–≤–Ω—ñ

  function addToCart(prod, size = "M", qty = 1) {
    setCart((c) => {
      // –∑–Ω–∞–π—Ç–∏, —á–∏ –≤–∂–µ —î —Ç–∞–∫–∞ –ø–æ–∑–∏—Ü—ñ—è –∑ —Ç–∏–º —Å–∞–º–∏–º —Ä–æ–∑–º—ñ—Ä–æ–º
      const found = c.find((it) => it.id === prod.id && it.size === size);
      if (found) {
        return c.map((it) =>
          it.id === prod.id && it.size === size ? { ...it, qty: it.qty + qty } : it
        );
      }
      return [...c, { ...prod, size, qty }];
    });
  }

  function removeFromCart(index) {
    setCart((c) => c.filter((_, i) => i !== index));
  }

  function changeQty(index, delta) {
    setCart((c) =>
      c.map((it, i) => (i === index ? { ...it, qty: Math.max(1, it.qty + delta) } : it))
    );
  }

  function subtotal() {
    return cart.reduce((s, it) => s + it.price * it.qty, 0);
  }

  function discountAmount() {
    if (!appliedPromo) return 0;
    if (appliedPromo.type === "percent") return Math.round((subtotal() * appliedPromo.value) / 100);
    if (appliedPromo.type === "fixed") return appliedPromo.value;
    return 0;
  }

  function shippingCost() {
    const sub = subtotal() - discountAmount();
    return sub >= FREE_SHIPPING_THRESHOLD || sub === 0 ? 0 : 120; // —Ñ—ñ–∫—Å–æ–≤–∞–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∞ 120 –≥—Ä–Ω
  }

  function total() {
    return Math.max(0, subtotal() - discountAmount() + shippingCost());
  }

  function applyPromo() {
    const code = promo.trim().toUpperCase();
    // –¥–µ–º–æ-–∫–æ–¥–∏
    const codes = {
      WELCOME10: { type: "percent", value: 10, label: "-10% –¥–ª—è –Ω–æ–≤–∏—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤" },
      FREEDEL: { type: "fixed", value: 120, label: "–ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∞" },
      BUNDLE5: { type: "percent", value: 5, label: "-5% (–ø–∞–∫–µ—Ç–Ω–∞ –∑–Ω–∏–∂–∫–∞)" },
    };
    if (codes[code]) {
      setAppliedPromo({ code, ...codes[code] });
      setPromo("");
    } else {
      setAppliedPromo({ code: "INVALID", type: "fixed", value: 0, label: "–ù–µ–≤—ñ—Ä–Ω–∏–π –∫–æ–¥" });
    }
  }

  function checkout() {
    // –Ü–º—ñ—Ç–∞—Ü—ñ—è checkout ‚Äî –æ—á–∏—â–∞—î –∫–æ—à–∏–∫ —ñ –ø–æ–∫–∞–∑—É—î –ø–æ–¥—è–∫—É
    setCart([]);
    setAppliedPromo(null);
    setShowThank(true);
    setTimeout(() => setShowThank(false), 4000);
  }

  // –ü–æ–¥–∞—Ä—É–Ω–æ–∫: –ø—Ä–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—ñ –≤—ñ–¥ 1500 –≥—Ä–Ω –¥–æ–¥–∞—î–º–æ –±—Ä–µ–Ω–¥–æ–≤–∞–Ω—É –Ω–∞–ª—ñ–ø–∫—É/—à–æ–ø–µ—Ä
  function giftEligible() {
    return subtotal() >= 1500;
  }

  return (
    <div className="min-h-screen bg-gray-50 text-gray-900">
      <header className="bg-white shadow-sm">
        <div className="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
          <div className="flex items-center gap-3">
            <div className="w-10 h-10 rounded-xl bg-gradient-to-br from-indigo-500 to-pink-500 flex items-center justify-center text-white font-bold">KS</div>
            <div>
              <h1 className="text-lg font-semibold">Kofty Studio</h1>
              <p className="text-xs text-gray-500">–ï–∫–æ–ª–æ–≥—ñ—á–Ω—ñ –∫–æ—Ñ—Ç–∏, —Ä—É—á–Ω–∞ —É–ø–∞–∫–æ–≤–∫–∞</p>
            </div>
          </div>

          <nav className="flex items-center gap-4">
            <button className="text-sm px-3 py-2 border rounded-md">–ö–∞—Ç–∞–ª–æ–≥</button>
            <button className="text-sm px-3 py-2 bg-indigo-600 text-white rounded-md" onClick={() => window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' })}>
              –ö–æ–Ω—Ç–∞–∫—Ç–∏
            </button>
            <div className="relative">
              <button className="px-3 py-2 bg-white border rounded-md">–ö–æ—à–∏–∫ ({cart.length})</button>
            </div>
          </nav>
        </div>
      </header>

      <main className="max-w-6xl mx-auto px-4 py-8">
        <section className="grid md:grid-cols-3 gap-8 items-center">
          <div className="md:col-span-2">
            <h2 className="text-3xl font-extrabold">–ö–æ—Ñ—Ç–∏ –∑ –¥—É—à–µ—é ‚Äî —Å—Ç–∞—Ä—Ç –∫–æ–ª–µ–∫—Ü—ñ—ó</h2>
            <p className="mt-3 text-gray-600">–ù–µ–≤–µ–ª–∏–∫—ñ —Ç–∏—Ä–∞–∂—ñ, –ø—Ä–∏—î–º–Ω—ñ —Ç–∫–∞–Ω–∏–Ω–∏, –ø–∞–∫—É–≤–∞–Ω–Ω—è —è–∫ –ø–æ–¥–∞—Ä—É–Ω–æ–∫. –ö—É–ø—É–π –∑–∞—Ä–∞–∑ ‚Äî –æ—Ç—Ä–∏–º–∞–π –±–æ–Ω—É—Å.</p>

            <div className="mt-6 grid sm:grid-cols-2 gap-4">
              {products.map((p) => (
                <article key={p.id} className="bg-white rounded-2xl shadow-sm p-4 flex flex-col">
                  <img src={p.img} alt={p.name} className="rounded-lg object-cover h-40 w-full mb-3" />
                  <div className="flex-1">
                    <h3 className="font-semibold">{p.name}</h3>
                    <p className="text-sm text-gray-500">{p.color}</p>
                  </div>
                  <div className="mt-3 flex items-center justify-between">
                    <div>
                      <div className="text-lg font-bold">{p.price} ‚Ç¥</div>
                      <div className="text-xs text-gray-500">–†–æ–∑–º—ñ—Ä–∏: {p.sizes.join(', ')}</div>
                    </div>
                    <div className="flex flex-col gap-2">
                      <select className="border rounded px-2 py-1 text-sm" defaultValue={p.sizes[0]} id={`size-${p.id}`}>
                        {p.sizes.map((s) => (
                          <option key={s} value={s}>{s}</option>
                        ))}
                      </select>
                      <button
                        className="px-3 py-2 bg-indigo-600 text-white rounded-md text-sm"
                        onClick={() => {
                          const sel = document.getElementById(`size-${p.id}`);
                          const size = sel ? sel.value : p.sizes[0];
                          addToCart(p, size, 1);
                        }}
                      >
                        –î–æ–¥–∞—Ç–∏ –≤ –∫–æ—à–∏–∫
                      </button>
                    </div>
                  </div>
                </article>
              ))}
            </div>
          </div>

          <aside className="bg-white rounded-2xl shadow p-5">
            <h3 className="font-semibold">–®–≤–∏–¥–∫–æ –ø—Ä–æ –∞–∫—Ü—ñ—ó</h3>
            <ul className="mt-3 text-sm text-gray-600 space-y-2">
              <li>üéÅ –ü–æ–¥–∞—Ä—É–Ω–æ–∫ (–±—Ä–µ–Ω–¥–æ–≤–∞–Ω–∞ –Ω–∞–ª—ñ–ø–∫–∞) –ø—Ä–∏ —Å—É–º—ñ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥ 1500 ‚Ç¥</li>
              <li>üöö –ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∞ –¥–æ—Å—Ç–∞–≤–∫–∞ –≤—ñ–¥ {FREE_SHIPPING_THRESHOLD} ‚Ç¥</li>
              <li>‚ú® –ü—Ä–æ–º–æ–∫–æ–¥ WELCOME10 ‚Äî -10% –¥–ª—è –Ω–æ–≤–∏—Ö –∫–ª—ñ—î–Ω—Ç—ñ–≤</li>
            </ul>

            <div className="mt-4">
              <label className="block text-sm text-gray-700">–ü—Ä–æ–º–æ–∫–æ–¥</label>
              <div className="flex gap-2 mt-2">
                <input value={promo} onChange={(e) => setPromo(e.target.value)} placeholder="–í–≤–µ–¥—ñ—Ç—å –∫–æ–¥" className="flex-1 border rounded px-3 py-2" />
                <button onClick={applyPromo} className="px-3 py-2 bg-green-600 text-white rounded-md">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
              </div>
              {appliedPromo && (
                <div className="mt-2 text-sm">
                  {appliedPromo.code === 'INVALID' ? (
                    <span className="text-red-600">–ù–µ–≤—ñ—Ä–Ω–∏–π –∫–æ–¥</span>
                  ) : (
                    <span className="text-green-700">–ó–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–æ: {appliedPromo.label}</span>
                  )}
                </div>
              )}
            </div>

            <div className="mt-5 border-t pt-4">
              <h4 className="font-medium">–ö–æ—à–∏–∫</h4>
              {cart.length === 0 ? (
                <p className="text-sm text-gray-500 mt-3">–ö–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π</p>
              ) : (
                <div className="space-y-3 mt-3">
                  {cart.map((it, i) => (
                    <div key={i} className="flex items-center gap-3">
                      <img src={it.img} alt={it.name} className="w-12 h-12 rounded object-cover" />
                      <div className="flex-1">
                        <div className="text-sm font-medium">{it.name} ‚Äî {it.size}</div>
                        <div className="text-xs text-gray-500">{it.price} ‚Ç¥ x {it.qty}</div>
                      </div>
                      <div className="flex items-center gap-2">
                        <button className="px-2" onClick={() => changeQty(i, -1)}>-</button>
                        <button className="px-2" onClick={() => changeQty(i, +1)}>+</button>
                        <button className="px-2 text-red-600" onClick={() => removeFromCart(i)}>‚úï</button>
                      </div>
                    </div>
                  ))}

                  <div className="text-sm">
                    <div className="flex justify-between"><span>–ü—ñ–¥—Å—É–º–æ–∫</span><span>{subtotal()} ‚Ç¥</span></div>
                    <div className="flex justify-between"><span>–ó–Ω–∏–∂–∫–∞</span><span>-{discountAmount()} ‚Ç¥</span></div>
                    <div className="flex justify-between"><span>–î–æ—Å—Ç–∞–≤–∫–∞</span><span>{shippingCost()} ‚Ç¥</span></div>
                    <div className="flex justify-between font-bold mt-2"><span>–†–∞–∑–æ–º</span><span>{total()} ‚Ç¥</span></div>
                  </div>

                  <div className="mt-3">
                    <button onClick={checkout} className="w-full py-2 bg-indigo-600 text-white rounded-md">–û—Ñ–æ—Ä–º–∏—Ç–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</button>
                  </div>
                </div>
              )}
            </div>

            <div className="mt-4 text-xs text-gray-500">
              <p>–ü–∞–∫—É–≤–∞–Ω–Ω—è: –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∞ –µ—Å—Ç–µ—Ç–∏—á–Ω–∞ —É–ø–∞–∫–æ–≤–∫–∞ –¥–æ –∫–æ–∂–Ω–æ–≥–æ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è. –ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É –ª–∏—Å—Ç—ñ–≤–∫—É</p>
            </div>
          </aside>
        </section>

        <section className="mt-12 bg-white rounded-2xl p-6 shadow-sm">
          <h3 className="font-semibold">–ß–æ–º—É —Ü–µ –ø—Ä–∞—Ü—é—î</h3>
          <div className="mt-3 grid sm:grid-cols-3 gap-4 text-sm text-gray-600">
            <div>
              <h4 className="font-medium">–ü–æ–¥–∞—Ä—É–Ω–∫–∏</h4>
              <p className="mt-1">–ú–∞–ª–µ–Ω—å–∫–∏–π –±–æ–Ω—É—Å ‚Äî –Ω–∞–ª—ñ–ø–∫–∞ –∞–±–æ —à–æ–ø–µ—Ä ‚Äî –ø—ñ–¥–≤–∏—â—É—î —Ü—ñ–Ω–Ω—ñ—Å—Ç—å –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è —ñ —à–∞–Ω—Å –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏—Å—å.</p>
            </div>
            <div>
              <h4 className="font-medium">–ü—Ä–æ–º–æ–∫–æ–¥–∏</h4>
              <p className="mt-1">WELCOME10 –ø—Ä–∏–≤–µ—Ä—Ç–∞—î –ø–µ—Ä—à–∏—Ö –ø–æ–∫—É–ø—Ü—ñ–≤, –∞ BUNDLE5 –º–æ—Ç–∏–≤—É—î –≤–∑—è—Ç–∏ 2+ —Ä–µ—á—ñ.</p>
            </div>
            <div>
              <h4 className="font-medium">–ü–∞–∫—É–≤–∞–Ω–Ω—è</h4>
              <p className="mt-1">–ü–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–∞–∫—É–≤–∞–Ω–Ω—è ‚Äî –≤–µ–ª–∏–∫–∞ —Ä—ñ—á –ø—Ä–∏ —ñ–Ω—Å—Ç–∞–≥—Ä–∞–º-—Ä–æ–∑–ø–∞–∫–æ–≤–∫–∞—Ö.</p>
            </div>
          </div>
        </section>

        <footer className="mt-8 text-center text-sm text-gray-500">
          <p>¬© {new Date().getFullYear()} Kofty Studio ‚Äî –ó–≤'—è–∑–æ–∫: +380 00 000 000</p>
        </footer>
      </main>

      {/* Thank you toast */}
      {showThank && (
        <div className="fixed right-6 bottom-6 bg-white shadow-lg rounded-lg p-4">
          <strong>–î—è–∫—É—î–º–æ –∑–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è!</strong>
          <div className="text-sm text-gray-600">–ú–∏ –∑–≤'—è–∂–µ–º–æ—Å—è –∑ –≤–∞–º–∏ –Ω–∞–π–±–ª–∏–∂—á–∏–º —á–∞—Å–æ–º</div>
        </div>
      )}
    </div>
  );
}
